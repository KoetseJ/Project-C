@model IEnumerable<webtest.Models.Book>
@using webtest.Models
@{
    ViewBag.Title = "Favorites";
    Layout = "~/Views/Shared/_customLayout.cshtml";
}
<link href="~/Content/SearchResults.css" rel="stylesheet" />

<h2>@ViewBag.Title.</h2>
<h3>@ViewBag.Message</h3>

@foreach (var m in Model)
{
    <!-- De ForEachLoop zorgt ervoor dat alle producten met verschillende waardes en dezelfde opmaak onder elkaar worden geplaatst.-->
    <div id="product">

        <a href="@Url.Action("Index", "Product", new { Title = m.Name })">
            <img id="productImg" src="@m.Image_src" />
        </a>

        <label id="price">€@m.Price</label>
        <a href="@Url.Action("Index", "Product", new { Title = m.Name }) " id="title">@m.Name</a>
        <!-- Change to author-->
        <label id="author">@m.Author</label>
        @switch (m.Rating)
        {
            case 1:
                <img id="rating" src="~/Content/Images/Rating1Star.png" />
                break;
            case 2:
                <img id="rating" src="~/Content/Images/Rating2Star.png" />
                break;
            case 3:
                <img id="rating" src="~/Content/Images/Rating3Star.png" />
                break;
            case 4:
                <img id="rating" src="~/Content/Images/Rating4Star.png" />
                break;
            case 5:
                <img id="rating" src="~/Content/Images/Rating5Star.png" />
                break;
        }

        <label id="summary">
            @{string mktText = m.Summary;
                if (mktText == null)
                {
                    mktText = "";
                }
                else
                {
                    if (mktText.Length > 250)
                    {
                        int pos = mktText.LastIndexOf(" ", 250);

                        mktText = mktText.Substring(0, pos) + "...";
                    }
                }
            }
            @mktText;
        </label>

        <a href="@Url.Action("Index", "Favorites", new { delete = m.ISBN}) " id="btnWishList">Remove Favo</a>
        @*<button id="btnCart">ADD TO CART</button>*@
        @{
            if (Session["User_id"] != null)
            {
                var dbCart = new DatabaseEntities1();
                var listCart = dbCart.Carts.Select(s => s);
                double isbnDCart = Convert.ToDouble(m.ISBN);
                int User_id_Cart = Convert.ToInt32(Session["User_id"]);

                bool hasCart = listCart.Any(cus => cus.ISBN == isbnDCart && cus.User_id == User_id_Cart);

                if (hasCart)
                {
                    <a href="@Url.Action("Index", "Favorites", new {cart = m.ISBN})" id="btnCart">Remove From Cart</a>
                }
                else
                {
                    <a href="@Url.Action("Index", "Favorites", new {cart = m.ISBN})" id="btnCart">Add to Cart</a>
                }


            }
        }

        }


        <label id="priceSmall">@m.Price</label>
        <a href="@Url.Action("Index", "Product", new { Title = m.Name , summary = m.Summary}) " id="moreInfo">More info</a>


        <a href="" id="moreInfoSmall">More info</a>


        <img id="stripe" src="~/Content/Images/stripe.png" />



    </div>
}


